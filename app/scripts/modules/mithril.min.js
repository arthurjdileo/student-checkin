function e(e,n,t,r,i,l){return{tag:e,key:n,attrs:t,children:r,text:i,dom:l,domSize:undefined,state:undefined,events:undefined,instance:undefined}}e.normalize=function(n){if(Array.isArray(n))return e("[",undefined,undefined,e.normalizeChildren(n),undefined,undefined);if(n!=null&&typeof n!=="object")return e("#",undefined,undefined,n===false?"":n,undefined,undefined);return n};e.normalizeChildren=function(n){var t=[];for(var r=0;r<n.length;r++){t[r]=e.normalize(n[r])}return t};var n=function(){var n=arguments[this],t=this+1,r;if(n==null){n={}}else if(typeof n!=="object"||n.tag!=null||Array.isArray(n)){n={};t=this}if(arguments.length===t+1){r=arguments[t];if(!Array.isArray(r))r=[r]}else{r=[];while(t<arguments.length)r.push(arguments[t++])}return e("",n.key,n,r)};var t=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g;var r={};var i={}.hasOwnProperty;function l(e){for(var n in e)if(i.call(e,n))return false;return true}function a(e){var n,i="div",l=[],a={};while(n=t.exec(e)){var o=n[1],f=n[2];if(o===""&&f!=="")i=f;else if(o==="#")a.id=f;else if(o===".")l.push(f);else if(n[3][0]==="["){var u=n[6];if(u)u=u.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\");if(n[4]==="class")l.push(u);else a[n[4]]=u===""?u:u||true}}if(l.length>0)a.className=l.join(" ");return r[e]={tag:i,attrs:a}}function o(n,t){var r=t.attrs;var a=e.normalizeChildren(t.children);var o=i.call(r,"class");var f=o?r.class:r.className;t.tag=n.tag;t.attrs=null;t.children=undefined;if(!l(n.attrs)&&!l(r)){var u={};for(var s in r){if(i.call(r,s))u[s]=r[s]}r=u}for(var s in n.attrs){if(i.call(n.attrs,s)&&s!=="className"&&!i.call(r,s)){r[s]=n.attrs[s]}}if(f!=null||n.attrs.className!=null)r.className=f!=null?n.attrs.className!=null?String(n.attrs.className)+" "+String(f):f:n.attrs.className!=null?n.attrs.className:null;if(o)r.class=null;for(var s in r){if(i.call(r,s)&&s!=="key"){t.attrs=r;break}}if(Array.isArray(a)&&a.length===1&&a[0]!=null&&a[0].tag==="#"){t.text=a[0].children}else{t.children=a}return t}function f(e){if(e==null||typeof e!=="string"&&typeof e!=="function"&&typeof e.view!=="function"){throw Error("The selector must be either a string or a component.")}var t=n.apply(1,arguments);if(typeof e==="string"){return o(r[e]||a(e),t)}else{t.tag=e;return t}}f.trust=function(n){if(n==null)n="";return e("<",undefined,undefined,n,undefined,undefined)};f.fragment=function(){var t=n.apply(0,arguments);t.tag="[";t.children=e.normalizeChildren(t.children);return t};var u=function e(){return f.apply(this,arguments)};u.m=f;u.trust=f.trust;u.fragment=f.fragment;export function buildQueryString(e){if(Object.prototype.toString.call(e)!=="[object Object]")return"";var n=[];for(var t in e){r(t,e[t])}return n.join("&");function r(e,t){if(Array.isArray(t)){for(var i=0;i<t.length;i++){r(e+"["+i+"]",t[i])}}else if(Object.prototype.toString.call(t)==="[object Object]"){for(var i in t){r(e+"["+i+"]",t[i])}}else n.push(encodeURIComponent(e)+(t!=null&&t!==""?"="+encodeURIComponent(t):""))}};var s=function(n){var t=n.document;var r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};var i;function l(e){return i=e}function a(e){return e.attrs&&e.attrs.xmlns||r[e.tag]}function o(e,n){if(e.state!==n)throw new Error("`vnode.state` must not be modified")}function f(e){var n=e.state;try{return this.apply(n,arguments)}finally{o(e,n)}}function u(){try{return t.activeElement}catch(e){return null}}function s(e,n,t,r,i,l,a){for(var o=t;o<r;o++){var f=n[o];if(f!=null){c(e,f,i,a,l)}}}function c(e,n,t,r,i){var l=n.tag;if(typeof l==="string"){n.state={};if(n.attrs!=null)J(n.attrs,n,t);switch(l){case"#":d(e,n,i);break;case"<":h(e,n,r,i);break;case"[":m(e,n,t,r,i);break;default:p(e,n,t,r,i)}}else y(e,n,t,r,i)}function d(e,n,r){n.dom=t.createTextNode(n.children);j(e,n.dom,r)}var v={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function h(e,n,r,i){var l=n.children.match(/^\s*?<(\w+)/im)||[];var a=t.createElement(v[l[1]]||"div");if(r==="http://www.w3.org/2000/svg"){a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+n.children+"</svg>";a=a.firstChild}else{a.innerHTML=n.children}n.dom=a.firstChild;n.domSize=a.childNodes.length;var o=t.createDocumentFragment();var f;while(f=a.firstChild){o.appendChild(f)}j(e,o,i)}function m(e,n,r,i,l){var a=t.createDocumentFragment();if(n.children!=null){var o=n.children;s(a,o,0,o.length,r,null,i)}n.dom=a.firstChild;n.domSize=a.childNodes.length;j(e,a,l)}function p(n,r,i,l,o){var f=r.tag;var u=r.attrs;var c=u&&u.is;l=a(r)||l;var d=l?c?t.createElementNS(l,f,{is:c}):t.createElementNS(l,f):c?t.createElement(f,{is:c}):t.createElement(f);r.dom=d;if(u!=null){P(r,u,l)}j(n,d,o);if(u!=null&&u.contenteditable!=null){I(r)}else{if(r.text!=null){if(r.text!=="")d.textContent=r.text;else r.children=[e("#",undefined,undefined,r.text,undefined,undefined)]}if(r.children!=null){var v=r.children;s(d,v,0,v.length,i,null,l);if(r.tag==="select"&&u!=null)M(r,u)}}}function g(n,t){var r;if(typeof n.tag.view==="function"){n.state=Object.create(n.tag);r=n.state.view;if(r.$$reentrantLock$$!=null)return;r.$$reentrantLock$$=true}else{n.state=void 0;r=n.tag;if(r.$$reentrantLock$$!=null)return;r.$$reentrantLock$$=true;n.state=n.tag.prototype!=null&&typeof n.tag.prototype.view==="function"?new n.tag(n):n.tag(n)}J(n.state,n,t);if(n.attrs!=null)J(n.attrs,n,t);n.instance=e.normalize(f.call(n.state.view,n));if(n.instance===n)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null}function y(e,n,t,r,i){g(n,t);if(n.instance!=null){c(e,n.instance,t,r,i);n.dom=n.instance.dom;n.domSize=n.dom!=null?n.instance.domSize:0}else{n.domSize=0}}function w(e,n,t,r,i,l){if(n===t||n==null&&t==null)return;else if(n==null||n.length===0)s(e,t,0,t.length,r,i,l);else if(t==null||t.length===0)O(n,0,n.length);else{var a=0,o=0,f=null,u=null;for(;o<n.length;o++){if(n[o]!=null){f=n[o].key!=null;break}}for(;a<t.length;a++){if(t[a]!=null){u=t[a].key!=null;break}}if(u===null&&f==null)return;if(f!==u){O(n,o,n.length);s(e,t,a,t.length,r,i,l)}else if(!u){var d=n.length<t.length?n.length:t.length;a=a<o?a:o;for(;a<d;a++){p=n[a];g=t[a];if(p===g||p==null&&g==null)continue;else if(p==null)c(e,g,r,l,$(n,a+1,i));else if(g==null)L(p);else b(e,p,g,r,$(n,a+1,i),l)}if(n.length>d)O(n,a,n.length);if(t.length>d)s(e,t,a,t.length,r,i,l)}else{var v=n.length-1,h=t.length-1,m,p,g,y,w,x;while(v>=o&&h>=a){y=n[v];w=t[h];if(y==null)v--;else if(w==null)h--;else if(y.key===w.key){if(y!==w)b(e,y,w,r,i,l);if(w.dom!=null)i=w.dom;v--,h--}else{break}}while(v>=o&&h>=a){p=n[o];g=t[a];if(p==null)o++;else if(g==null)a++;else if(p.key===g.key){o++,a++;if(p!==g)b(e,p,g,r,$(n,o,i),l)}else{break}}while(v>=o&&h>=a){if(p==null)o++;else if(g==null)a++;else if(y==null)v--;else if(w==null)h--;else if(a===h)break;else{if(p.key!==w.key||y.key!==g.key)break;x=$(n,o,i);j(e,N(y),x);if(y!==g)b(e,y,g,r,x,l);if(++a<=--h)j(e,N(p),i);if(p!==w)b(e,p,w,r,i,l);if(w.dom!=null)i=w.dom;o++;v--}y=n[v];w=t[h];p=n[o];g=t[a]}while(v>=o&&h>=a){if(y==null)v--;else if(w==null)h--;else if(y.key===w.key){if(y!==w)b(e,y,w,r,i,l);if(w.dom!=null)i=w.dom;v--,h--}else{break}y=n[v];w=t[h]}if(a>h)O(n,o,v+1);else if(o>v)s(e,t,a,h+1,r,i,l);else{var S=i,k=h-a+1,A=new Array(k),z=0,I=0,R=2147483647,P=0,m,T;for(I=0;I<k;I++)A[I]=-1;for(I=h;I>=a;I--){if(m==null)m=C(n,o,v+1);w=t[I];if(w!=null){var Q=m[w.key];if(Q!=null){R=Q<R?Q:-1;A[I-a]=Q;y=n[Q];n[Q]=null;if(y!==w)b(e,y,w,r,i,l);if(w.dom!=null)i=w.dom;P++}}}i=S;if(P!==v-o+1)O(n,o,v+1);if(P===0)s(e,t,a,h+1,r,i,l);else{if(R===-1){T=E(A);z=T.length-1;for(I=h;I>=a;I--){g=t[I];if(A[I-a]===-1)c(e,g,r,l,i);else{if(T[z]===I-a)z--;else j(e,N(g),i)}if(g.dom!=null)i=t[I].dom}}else{for(I=h;I>=a;I--){g=t[I];if(A[I-a]===-1)c(e,g,r,l,i);if(g.dom!=null)i=t[I].dom}}}}}}}function b(e,n,t,r,i,l){var a=n.tag,o=t.tag;if(a===o){t.state=n.state;t.events=n.events;if(X(t,n))return;if(typeof a==="string"){if(t.attrs!=null){W(t.attrs,t,r)}switch(a){case"#":x(n,t);break;case"<":S(e,n,t,l,i);break;case"[":k(e,n,t,r,i,l);break;default:A(n,t,r,l)}}else z(e,n,t,r,i,l)}else{L(n);c(e,t,r,l,i)}}function x(e,n){if(e.children.toString()!==n.children.toString()){e.dom.nodeValue=n.children}n.dom=e.dom}function S(e,n,t,r,i){if(n.children!==t.children){N(n);h(e,t,r,i)}else t.dom=n.dom,t.domSize=n.domSize}function k(e,n,t,r,i,l){w(e,n.children,t.children,r,i,l);var a=0,o=t.children;t.dom=null;if(o!=null){for(var f=0;f<o.length;f++){var u=o[f];if(u!=null&&u.dom!=null){if(t.dom==null)t.dom=u.dom;a+=u.domSize||1}}if(a!==1)t.domSize=a}}function A(n,t,r,i){var l=t.dom=n.dom;i=a(t)||i;if(t.tag==="textarea"){if(t.attrs==null)t.attrs={};if(t.text!=null){t.attrs.value=t.text;t.text=undefined}}D(t,n.attrs,t.attrs,i);if(t.attrs!=null&&t.attrs.contenteditable!=null){I(t)}else if(n.text!=null&&t.text!=null&&t.text!==""){if(n.text.toString()!==t.text.toString())n.dom.firstChild.nodeValue=t.text}else{if(n.text!=null)n.children=[e("#",undefined,undefined,n.text,undefined,n.dom.firstChild)];if(t.text!=null)t.children=[e("#",undefined,undefined,t.text,undefined,undefined)];w(l,n.children,t.children,r,null,i)}}function z(n,t,r,i,l,a){r.instance=e.normalize(f.call(r.state.view,r));if(r.instance===r)throw Error("A view cannot return the vnode it received as argument");W(r.state,r,i);if(r.attrs!=null)W(r.attrs,r,i);if(r.instance!=null){if(t.instance==null)c(n,r.instance,i,a,l);else b(n,t.instance,r.instance,i,l,a);r.dom=r.instance.dom;r.domSize=r.instance.domSize}else if(t.instance!=null){L(t.instance);r.dom=undefined;r.domSize=0}else{r.dom=t.dom;r.domSize=t.domSize}}function C(e,n,t){var r=Object.create(null);for(;n<t;n++){var i=e[n];if(i!=null){var l=i.key;if(l!=null)r[l]=n}}return r}function E(e){var n=e.slice();var t=[];t.push(0);var r;var i;for(var l=0,a=e.length;l<a;++l){if(e[l]===-1){continue}var o=t[t.length-1];if(e[o]<e[l]){n[l]=o;t.push(l);continue}r=0;i=t.length-1;while(r<i){var f=(r+i)/2|0;if(e[t[f]]<e[l]){r=f+1}else{i=f}}if(e[l]<e[t[r]]){if(r>0){n[l]=t[r-1]}t[r]=l}}r=t.length;i=t[r-1];while(r-- >0){t[r]=i;i=n[i]}return t}function N(e){var n=e.domSize;if(n!=null||e.dom==null){var r=t.createDocumentFragment();if(n>0){var i=e.dom;while(--n)r.appendChild(i.nextSibling);r.insertBefore(i,r.firstChild)}return r}else return e.dom}function $(e,n,t){for(;n<e.length;n++){if(e[n]!=null&&e[n].dom!=null)return e[n].dom}return t}function j(e,n,t){if(t!=null)e.insertBefore(n,t);else e.appendChild(n)}function I(e){var n=e.children;if(n!=null&&n.length===1&&n[0].tag==="<"){var t=n[0].children;if(e.dom.innerHTML!==t)e.dom.innerHTML=t}else if(e.text!=null||n!=null&&n.length!==0)throw new Error("Child node of a contenteditable must be trusted")}function O(e,n,t){for(var r=n;r<t;r++){var i=e[r];if(i!=null)L(i)}}function L(e){var n=1,t=0;var r=e.state;if(typeof e.tag!=="string"&&typeof e.state.onbeforeremove==="function"){var i=f.call(e.state.onbeforeremove,e);if(i!=null&&typeof i.then==="function"){n++;i.then(l,l)}}if(e.attrs&&typeof e.attrs.onbeforeremove==="function"){var i=f.call(e.attrs.onbeforeremove,e);if(i!=null&&typeof i.then==="function"){n++;i.then(l,l)}}l();function l(){if(++t===n){o(e,r);R(e);if(e.dom){var i=e.dom.parentNode;var l=e.domSize||1;while(--l)i.removeChild(e.dom.nextSibling);i.removeChild(e.dom)}}}}function R(e){if(typeof e.tag!=="string"&&typeof e.state.onremove==="function")f.call(e.state.onremove,e);if(e.attrs&&typeof e.attrs.onremove==="function")f.call(e.attrs.onremove,e);if(typeof e.tag!=="string"){if(e.instance!=null)R(e.instance)}else{var n=e.children;if(Array.isArray(n)){for(var t=0;t<n.length;t++){var r=n[t];if(r!=null)R(r)}}}}function P(e,n,t){for(var r in n){T(e,r,null,n[r],t)}}function T(e,n,t,r,i){if(n==="key"||n==="is"||r==null||F(n)||t===r&&!U(e,n)&&typeof r!=="object")return;if(n[0]==="o"&&n[1]==="n")return G(e,n,r);if(n.slice(0,6)==="xlink:")e.dom.setAttributeNS("http://www.w3.org/1999/xlink",n.slice(6),r);else if(n==="style")q(e.dom,t,r);else if(H(e,n,i)){if(n==="value"){if((e.tag==="input"||e.tag==="textarea")&&e.dom.value===""+r&&e.dom===u())return;if(e.tag==="select"&&t!==null&&e.dom.value===""+r)return;if(e.tag==="option"&&t!==null&&e.dom.value===""+r)return}if(e.tag==="input"&&n==="type")e.dom.setAttribute(n,r);else e.dom[n]=r}else{if(typeof r==="boolean"){if(r)e.dom.setAttribute(n,"");else e.dom.removeAttribute(n)}else e.dom.setAttribute(n==="className"?"class":n,r)}}function Q(e,n,t,r){if(n==="key"||n==="is"||t==null||F(n))return;if(n[0]==="o"&&n[1]==="n"&&!F(n))G(e,n,undefined);else if(n==="style")q(e.dom,t,null);else if(H(e,n,r)&&n!=="className"&&!(n==="value"&&(e.tag==="option"||e.tag==="select"&&e.dom.selectedIndex===-1&&e.dom===u()))&&!(e.tag==="input"&&n==="type")){e.dom[n]=null}else{var i=n.indexOf(":");if(i!==-1)n=n.slice(i+1);if(t!==false)e.dom.removeAttribute(n==="className"?"class":n)}}function M(e,n){if("value"in n){if(n.value===null){if(e.dom.selectedIndex!==-1)e.dom.value=null}else{var t=""+n.value;if(e.dom.value!==t||e.dom.selectedIndex===-1){e.dom.value=t}}}if("selectedIndex"in n)T(e,"selectedIndex",null,n.selectedIndex,undefined)}function D(e,n,t,r){if(t!=null){for(var i in t){T(e,i,n&&n[i],t[i],r)}}var l;if(n!=null){for(var i in n){if((l=n[i])!=null&&(t==null||t[i]==null)){Q(e,i,l,r)}}}}function U(e,n){return n==="value"||n==="checked"||n==="selectedIndex"||n==="selected"&&e.dom===u()||e.tag==="option"&&e.dom.parentNode===t.activeElement}function F(e){return e==="oninit"||e==="oncreate"||e==="onupdate"||e==="onremove"||e==="onbeforeremove"||e==="onbeforeupdate"}function H(e,n,t){return t===undefined&&(e.tag.indexOf("-")>-1||e.attrs!=null&&e.attrs.is||n!=="href"&&n!=="list"&&n!=="form"&&n!=="width"&&n!=="height")&&n in e.dom}var K=/[A-Z]/g;function B(e){return"-"+e.toLowerCase()}function V(e){return e[0]==="-"&&e[1]==="-"?e:e==="cssFloat"?"float":e.replace(K,B)}function q(e,n,t){if(n===t){}else if(t==null){e.style.cssText=""}else if(typeof t!=="object"){e.style.cssText=t}else if(n==null||typeof n!=="object"){e.style.cssText="";for(var r in t){var i=t[r];if(i!=null)e.style.setProperty(V(r),String(i))}}else{for(var r in t){var i=t[r];if(i!=null&&(i=String(i))!==String(n[r])){e.style.setProperty(V(r),i)}}for(var r in n){if(n[r]!=null&&t[r]==null){e.style.removeProperty(V(r))}}}}function Z(){}Z.prototype=Object.create(null);Z.prototype.handleEvent=function(e){var n=this["on"+e.type];var t;if(typeof n==="function")t=n.call(e.currentTarget,e);else if(typeof n.handleEvent==="function")n.handleEvent(e);if(e.redraw===false)e.redraw=undefined;else if(typeof i==="function")i();if(t===false){e.preventDefault();e.stopPropagation()}};function G(e,n,t){if(e.events!=null){if(e.events[n]===t)return;if(t!=null&&(typeof t==="function"||typeof t==="object")){if(e.events[n]==null)e.dom.addEventListener(n.slice(2),e.events,false);e.events[n]=t}else{if(e.events[n]!=null)e.dom.removeEventListener(n.slice(2),e.events,false);e.events[n]=undefined}}else if(t!=null&&(typeof t==="function"||typeof t==="object")){e.events=new Z;e.dom.addEventListener(n.slice(2),e.events,false);e.events[n]=t}}function J(e,n,t){if(typeof e.oninit==="function")f.call(e.oninit,n);if(typeof e.oncreate==="function")t.push(f.bind(e.oncreate,n))}function W(e,n,t){if(typeof e.onupdate==="function")t.push(f.bind(e.onupdate,n))}function X(e,n){do{if(e.attrs!=null&&typeof e.attrs.onbeforeupdate==="function"){var t=f.call(e.attrs.onbeforeupdate,e,n);if(t!==undefined&&!t)break}if(typeof e.tag!=="string"&&typeof e.state.onbeforeupdate==="function"){var t=f.call(e.state.onbeforeupdate,e,n);if(t!==undefined&&!t)break}return false}while(false);e.dom=n.dom;e.domSize=n.domSize;e.instance=n.instance;return true}function Y(n,t){if(!n)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var r=[];var i=u();var l=n.namespaceURI;if(n.vnodes==null)n.textContent="";t=e.normalizeChildren(Array.isArray(t)?t:[t]);w(n,n.vnodes,t,r,null,l==="http://www.w3.org/1999/xhtml"?undefined:l);n.vnodes=t;if(i!=null&&u()!==i&&typeof i.focus==="function")i.focus();for(var a=0;a<r.length;a++)r[a]()}return{render:Y,setRedraw:l}};function c(e){var n=null;return function(){if(n===null){n=requestAnimationFrame(function(){n=null;e()})}}}var d=function(e,n){var t=s(e);var r=[];var i=false;function l(e,n){a(e);r.push(e,n)}function a(e){var n=r.indexOf(e);if(n>-1)r.splice(n,2)}function o(){if(i)throw new Error("Nested m.redraw.sync() call");i=true;for(var e=1;e<r.length;e+=2)try{r[e]()}catch(e){if(typeof console!=="undefined")console.error(e)}i=false}var f=(n||c)(o);f.sync=o;t.setRedraw(f);return{subscribe:l,unsubscribe:a,redraw:f,render:t.render}};var v=d(window);var h=function(n){return function(t,r){if(r===null){n.render(t,[]);n.unsubscribe(t);return}if(r.view==null&&typeof r!=="function")throw new Error("m.mount(element, component) expects a component, not a vnode");var i=function(){n.render(t,e(r))};n.subscribe(t,i);i()}};u.mount=h(v);export function parseQueryString(e){if(e===""||e==null)return{};if(e.charAt(0)==="?")e=e.slice(1);var n=e.split("&"),t={},r={};for(var i=0;i<n.length;i++){var l=n[i].split("=");var a=decodeURIComponent(l[0]);var o=l.length===2?decodeURIComponent(l[1]):"";if(o==="true")o=true;else if(o==="false")o=false;var f=a.split(/\]\[?|\[/);var u=t;if(a.indexOf("[")>-1)f.pop();for(var s=0;s<f.length;s++){var c=f[s],d=f[s+1];var v=d==""||!isNaN(parseInt(d,10));var h=s===f.length-1;if(c===""){var a=f.slice(0,s).join();if(r[a]==null)r[a]=0;c=r[a]++}if(u[c]==null){u[c]=h?o:v?[]:{}}u=u[c]}}return t};var m=function(e){var n=typeof e.history.pushState==="function";var t=typeof setImmediate==="function"?setImmediate:setTimeout;function r(n){var t=e.location[n].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);if(n==="pathname"&&t[0]!=="/")t="/"+t;return t}var i;function l(e){return function(){if(i!=null)return;i=t(function(){i=null;e()})}}function a(e,n,t){var r=e.indexOf("?");var i=e.indexOf("#");var l=r>-1?r:i>-1?i:e.length;if(r>-1){var a=i>-1?i:e.length;var o=parseQueryString(e.slice(r+1,a));for(var f in o)n[f]=o[f]}if(i>-1){var u=parseQueryString(e.slice(i+1));for(var f in u)t[f]=u[f]}return e.slice(0,l)}var o={prefix:"#!"};o.getPath=function(){var e=o.prefix.charAt(0);switch(e){case"#":return r("hash").slice(o.prefix.length);case"?":return r("search").slice(o.prefix.length)+r("hash");default:return r("pathname").slice(o.prefix.length)+r("search")+r("hash")}};o.setPath=function(t,r,i){var l={},f={};t=a(t,l,f);if(r!=null){for(var u in r)l[u]=r[u];t=t.replace(/:([^\/]+)/g,function(e,n){delete l[n];return r[n]})}var s=buildQueryString(l);if(s)t+="?"+s;var c=buildQueryString(f);if(c)t+="#"+c;if(n){var d=i?i.state:null;var v=i?i.title:null;e.onpopstate();if(i&&i.replace)e.history.replaceState(d,v,o.prefix+t);else e.history.pushState(d,v,o.prefix+t)}else e.location.href=o.prefix+t};o.defineRoutes=function(t,r,i){function f(){var n=o.getPath();var l={};var f=a(n,l,l);var u=e.history.state;if(u!=null){for(var s in u)l[s]=u[s]}for(var c in t){var d=new RegExp("^"+c.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(d.test(f)){f.replace(d,function(){var e=c.match(/:[^\/]+/g)||[];var i=[].slice.call(arguments,1,-2);for(var a=0;a<e.length;a++){l[e[a].replace(/:|\./g,"")]=decodeURIComponent(i[a])}r(t[c],l,n,c)});return}}i(n,l)}if(n)e.onpopstate=l(f);else if(o.prefix.charAt(0)==="#")e.onhashchange=f;f()};return o};var p=function(n,t){var r=m(n);var i=function(e){return e};var l,a,o,f,u;var s=function(n,s,c){if(n==null)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");function d(){if(l!=null)t.render(n,l(e(a,o.key,o)))}var v=function(){d();v=t.redraw};t.subscribe(n,d);var h=function(e){if(e!==s)r.setPath(s,null,{replace:true});else throw new Error("Could not resolve default route "+s)};r.defineRoutes(c,function(e,n,t){var r=u=function(e,s){if(r!==u)return;a=s!=null&&(typeof s.view==="function"||typeof s==="function")?s:"div";o=n,f=t,u=null;l=(e.render||i).bind(e);v()};if(e.view||typeof e==="function")r({},e);else{if(e.onmatch){Promise.resolve(e.onmatch(n,t)).then(function(n){r(e,n)},h)}else r(e,"div")}},h)};s.set=function(e,n,t){if(u!=null){t=t||{};t.replace=true}u=null;r.setPath(e,n,t)};s.get=function(){return f};s.prefix=function(e){r.prefix=e};var c=function(e,n){n.dom.setAttribute("href",r.prefix+n.attrs.href);n.dom.onclick=function(n){if(n.ctrlKey||n.metaKey||n.shiftKey||n.which===2)return;n.preventDefault();n.redraw=false;var t=this.getAttribute("href");if(t.indexOf(r.prefix)===0)t=t.slice(r.prefix.length);s.set(t,undefined,e)}};s.link=function(e){if(e.tag==null)return c.bind(c,e);return c({},e)};s.param=function(e){if(typeof o!=="undefined"&&typeof e!=="undefined")return o[e];return o};return s};u.route=p(window,v);var g=s(window);u.render=g.render;u.redraw=v.redraw;u.parseQueryString=parseQueryString;u.buildQueryString=buildQueryString;u.version="2.0.0-rc.3";u.vnode=e;export default u;var y=u.trust,w=u.fragment,b=u.mount,x=u.route,S=u.render,k=u.redraw,A=u.version;export{f as m,y as trust,w as fragment,b as mount,x as route,S as render,k as redraw,A as version,e as vnode};